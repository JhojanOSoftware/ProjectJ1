<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Formulario de Registro</title>
  <style>
    * {
      box-sizing: border-box;
    }

    body {
      font-family: Arial, sans-serif;
      background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
      display: grid;
      grid-template-columns: 1fr 1fr 1fr;
      grid-template-rows: 1fr;
      min-height: 100vh;
      gap: 20px;
      padding: 20px;
      overflow-x: auto;
      scroll-behavior: smooth;
    }

    /* Scrollbar personalizado */
    body::-webkit-scrollbar {
      height: 8px;
    }

    body::-webkit-scrollbar-track {
      background: rgba(0,0,0,0.1);
      border-radius: 10px;
    }

    body::-webkit-scrollbar-thumb {
      background: #667eea;
      border-radius: 10px;
    }

    body::-webkit-scrollbar-thumb:hover {
      background: #764ba2;
    }

    form {
      background-color: white;
      padding: 25px;
      border-radius: 15px;
      box-shadow: 0 10px 40px rgba(0,0,0,0.1);
      width: 100%;
      min-width: 400px;
      max-width: 450px;
      flex-shrink: 0;
      height: fit-content;
      animation: slideInLeft 0.5s ease-out;
      border: 1px solid rgba(102, 126, 234, 0.2);
    }

    @keyframes slideInLeft {
      from {
        opacity: 0;
        transform: translateX(-50px);
      }
      to {
        opacity: 1;
        transform: translateX(0);
      }
    }

    h2 {
      text-align: center;
      color: #333;
      margin: 0 0 15px 0;
    }

    label {
      display: block;
      margin-top: 10px;
      font-weight: bold;
      color: #333;
      font-size: 0.95rem;
    }

    input {
      width: 100%;
      padding: 10px;
      margin-top: 6px;
      border: 1px solid #ccc;
      border-radius: 5px;
      font-size: 1rem;
      transition: border-color 0.2s;
    }

    input:focus {
      outline: none;
      border-color: #007bff;
      box-shadow: 0 0 4px rgba(0, 123, 255, 0.3);
    }
.btn {
  --border-radius: 24px;
  --padding: 4px;
  --transition: 0.4s;
  --button-color: #101010;
  --highlight-color-hue: 210deg;

  position: relative;
  user-select: none;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
  padding: 0.7em 1.2em;
  font-family: "Poppins", "Inter", "Segoe UI", sans-serif;
  font-size: 1em;
  font-weight: 600;
  width: 100%;
  box-sizing: border-box;
  margin-bottom: 8px;

  background-color: var(--button-color);

  box-shadow:
    /* inset */
    inset 0px 1px 1px rgba(255, 255, 255, 0.2),
    inset 0px 2px 2px rgba(255, 255, 255, 0.15),
    inset 0px 4px 4px rgba(255, 255, 255, 0.1),
    inset 0px 8px 8px rgba(255, 255, 255, 0.05),
    inset 0px 16px 16px rgba(255, 255, 255, 0.05),
    /* drop */ 0px -1px 1px rgba(0, 0, 0, 0.02),
    0px -2px 2px rgba(0, 0, 0, 0.03),
    0px -4px 4px rgba(0, 0, 0, 0.05),
    0px -8px 8px rgba(0, 0, 0, 0.06),
    0px -16px 16px rgba(0, 0, 0, 0.08);

  border: solid 1px #fff2;
  border-radius: var(--border-radius);
  cursor: pointer;

  transition:
    box-shadow var(--transition),
    border var(--transition),
    background-color var(--transition);
}
.btn::before {
  content: "";
  position: absolute;
  top: calc(0px - var(--padding));
  left: calc(0px - var(--padding));
  width: calc(100% + var(--padding) * 2);
  height: calc(100% + var(--padding) * 2);
  border-radius: calc(var(--border-radius) + var(--padding));
  pointer-events: none;
  background-image: linear-gradient(0deg, #0004, #000a);

  z-index: -1;
  transition:
    box-shadow var(--transition),
    filter var(--transition);
  box-shadow:
    0 -8px 8px -6px #0000 inset,
    0 -16px 16px -8px #00000000 inset,
    1px 1px 1px #fff2,
    2px 2px 2px #fff1,
    -1px -1px 1px #0002,
    -2px -2px 2px #0001;
}
.btn::after {
  content: "";
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  border-radius: inherit;
  pointer-events: none;
  background-image: linear-gradient(
    0deg,
    #fff,
    hsl(var(--highlight-color-hue), 100%, 70%),
    hsla(var(--highlight-color-hue), 100%, 70%, 50%),
    8%,
    transparent
  );
  background-position: 0 0;
  opacity: 0;
  transition:
    opacity var(--transition),
    filter var(--transition);
}

.btn-letter {
  position: relative;
  display: inline-block;
  color: #fff5;
  animation: letter-anim 2s ease-in-out infinite;
  transition:
    color var(--transition),
    text-shadow var(--transition),
    opacity var(--transition);
}

@keyframes letter-anim {
  50% {
    text-shadow: 0 0 3px #fff8;
    color: #fff;
  }
}

.btn-svg {
  flex-shrink: 0;
  width: 24px;
  height: 24px;
  margin-right: 4px;
  fill: #e8e8e8;
  animation: flicker 2s linear infinite;
  animation-delay: 0.5s;
  filter: drop-shadow(0 0 2px #fff9);
  transition:
    fill var(--transition),
    filter var(--transition),
    opacity var(--transition);
}
@keyframes flicker {
  50% {
    opacity: 0.3;
  }
}

/* Focus state */
.txt-wrapper {
  position: relative;
  display: flex;
  align-items: center;
  justify-content: center;
  max-width: 100%;
  overflow: hidden;
}
.txt-1 {
  position: relative;
  display: flex;
  flex-wrap: wrap;
  gap: 2px;
  justify-content: center;
  align-items: center;
  word-break: break-word;
}
.txt-2 {
  display: none;
}
@keyframes appear-anim {
  0% {
    opacity: 0;
  }
  100% {
    opacity: 1;
  }
}
.btn:focus .txt-1 {
  animation: opacity-anim 0.3s ease-in-out forwards;
  animation-delay: 1s;
}
.btn:focus .txt-2 {
  animation: opacity-anim 0.3s ease-in-out reverse forwards;
  animation-delay: 1s;
}
@keyframes opacity-anim {
  0% {
    opacity: 1;
  }
  100% {
    opacity: 0;
  }
}

.btn:focus .btn-letter {
  animation:
    focused-letter-anim 1s ease-in-out forwards,
    letter-anim 1.2s ease-in-out infinite;
  animation-delay: 0s, 1s;
}
@keyframes focused-letter-anim {
  0%,
  100% {
    filter: blur(0px);
  }
  50% {
    transform: scale(2);
    filter: blur(10px) brightness(150%)
      drop-shadow(-36px 12px 12px hsl(var(--highlight-color-hue), 100%, 70%));
  }
}
.btn:focus .btn-svg {
  animation-duration: 1.2s;
  animation-delay: 0.2s;
}

.btn:focus::before {
  box-shadow:
    0 -8px 12px -6px #fff3 inset,
    0 -16px 16px -8px hsla(var(--highlight-color-hue), 100%, 70%, 20%) inset,
    1px 1px 1px #fff3,
    2px 2px 2px #fff1,
    -1px -1px 1px #0002,
    -2px -2px 2px #0001;
}
.btn:focus::after {
  opacity: 0.6;
  mask-image: linear-gradient(0deg, #fff, transparent);
  filter: brightness(100%);
}

/* Animation delays for .btn-letter elements */
.btn-letter:nth-child(1),
.btn:focus .btn-letter:nth-child(1) {
  animation-delay: 0s;
}
.btn-letter:nth-child(2),
.btn:focus .btn-letter:nth-child(2) {
  animation-delay: 0.08s;
}
.btn-letter:nth-child(3),
.btn:focus .btn-letter:nth-child(3) {
  animation-delay: 0.16s;
}
.btn-letter:nth-child(4),
.btn:focus .btn-letter:nth-child(4) {
  animation-delay: 0.24s;
}
.btn-letter:nth-child(5),
.btn:focus .btn-letter:nth-child(5) {
  animation-delay: 0.32s;
}
.btn-letter:nth-child(6),
.btn:focus .btn-letter:nth-child(6) {
  animation-delay: 0.4s;
}
.btn-letter:nth-child(7),
.btn:focus .btn-letter:nth-child(7) {
  animation-delay: 0.48s;
}
.btn-letter:nth-child(8),
.btn:focus .btn-letter:nth-child(8) {
  animation-delay: 0.56s;
}
.btn-letter:nth-child(9),
.btn:focus .btn-letter:nth-child(9) {
  animation-delay: 0.64s;
}
.btn-letter:nth-child(10),
.btn:focus .btn-letter:nth-child(10) {
  animation-delay: 0.72s;
}
.btn-letter:nth-child(11),
.btn:focus .btn-letter:nth-child(11) {
  animation-delay: 0.8s;
}
.btn-letter:nth-child(12),
.btn:focus .btn-letter:nth-child(12) {
  animation-delay: 0.88s;
}
.btn-letter:nth-child(13),
.btn:focus .btn-letter:nth-child(13) {
  animation-delay: 0.96s;
}

/* Active state */
.btn:active {
  border: solid 1px hsla(var(--highlight-color-hue), 100%, 80%, 70%);
  background-color: hsla(var(--highlight-color-hue), 50%, 20%, 0.5);
}
.btn:active::before {
  box-shadow:
    0 -8px 12px -6px #fffa inset,
    0 -16px 16px -8px hsla(var(--highlight-color-hue), 100%, 70%, 80%) inset,
    1px 1px 1px #fff4,
    2px 2px 2px #fff2,
    -1px -1px 1px #0002,
    -2px -2px 2px #0001;
}
.btn:active::after {
  opacity: 1;
  mask-image: linear-gradient(0deg, #fff, transparent);
  filter: brightness(200%);
}
.btn:active .btn-letter {
  text-shadow: 0 0 1px hsla(var(--highlight-color-hue), 100%, 90%, 90%);
  animation: none;
}

/* Hover state */
.btn:hover {
  border: solid 1px hsla(var(--highlight-color-hue), 100%, 80%, 40%);
}

.btn:hover::before {
  box-shadow:
    0 -8px 8px -6px #fffa inset,
    0 -16px 16px -8px hsla(var(--highlight-color-hue), 100%, 70%, 30%) inset,
    1px 1px 1px #fff2,
    2px 2px 2px #fff1,
    -1px -1px 1px #0002,
    -2px -2px 2px #0001;
}

.btn:hover::after {
  opacity: 1;
  mask-image: linear-gradient(0deg, #fff, transparent);
}

.btn:hover .btn-svg {
  fill: #fff;
  filter: drop-shadow(0 0 3px hsl(var(--highlight-color-hue), 100%, 70%))
    drop-shadow(0 -4px 6px #0009);
  animation: none;
}

    
    
    
    select {
      width: 100%;
      padding: 10px;
      margin-top: 6px;
      border: 1px solid #ccc;
      border-radius: 5px;
      font-size: 1rem;
      transition: border-color 0.2s;
    }

    select:focus {
      outline: none;
      border-color: #007bff;
      box-shadow: 0 0 4px rgba(0, 123, 255, 0.3);
    }

    /* Vista Previa Colapsable */
    .previewoutput {
      display: none;
      flex-direction: column;
      width: 100%;
      min-width: 400px;
      max-width: 450px;
      background: white;
      border-radius: 15px;
      box-shadow: 0 10px 40px rgba(0,0,0,0.1);
      overflow: hidden;
      transition: all 0.3s ease;
      flex-shrink: 0;
      border: 1px solid rgba(102, 126, 234, 0.2);
      animation: slideInUp 0.5s ease-out;
    }

    @keyframes slideInUp {
      from {
        opacity: 0;
        transform: translateY(50px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .previewoutput.show {
      display: flex;
    }

    .preview-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 15px 20px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      cursor: pointer;
      user-select: none;
      transition: background 0.3s ease;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      font-size: 0.95rem;
    }

    .preview-header:hover {
      background: linear-gradient(135deg, #764ba2 0%, #667eea 100%);
    }

    .preview-header h3 {
      margin: 0;
      font-size: 1.1rem;
      flex-grow: 1;
    }

    .preview-toggle {
      font-size: 0.9rem;
      transition: transform 0.3s ease;
      display: inline-block;
      margin-left: 10px;
    }

    .preview-toggle.collapsed {
      transform: rotate(-90deg);
    }

    .preview-content {
      padding: 20px;
      max-height: 500px;
      overflow-y: auto;
      overflow-x: hidden;
      transition: max-height 0.3s ease, opacity 0.3s ease;
    }

    .preview-content.collapsed {
      max-height: 0;
      overflow: hidden;
      padding: 0 20px;
      opacity: 0;
    }

    .preview-content p {
      margin: 10px 0;
      color: #333;
    }

    .preview-content p strong {
      color: #667eea;
    }

    #previewList {
      margin: 15px 0;
    }

    #previewList > div {
      padding: 12px;
      margin-bottom: 12px;
      border: 1px solid #e0e0e0;
      border-radius: 8px;
      background: #f9f9f9;
      transition: all 0.2s ease;
    }

    #previewList > div:hover {
      border-color: #667eea;
      background: #f5f7ff;
      box-shadow: 0 2px 8px rgba(102, 126, 234, 0.1);
    }

    #previewList p {
      margin: 6px 0;
      font-size: 0.95rem;
    }

    /* Bot√≥n Bubbles para Editar */
    .bubbles {
      --c1: #fff;
      --c2: #212121;
      --size-letter: 16px;
      padding: 0.5em 1em;
      font-size: var(--size-letter);

      background-color: transparent;
      border: calc(var(--size-letter) / 6) solid var(--c2);
      border-radius: 0.2em;
      cursor: pointer;

      overflow: hidden;
      position: relative;
      transition: 300ms cubic-bezier(0.83, 0, 0.17, 1);
    }

    .bubbles > .text {
      font-weight: 700;
      color: var(--c2);
      position: relative;
      z-index: 1;
      transition: color 700ms cubic-bezier(0.83, 0, 0.17, 1);
    }

    .bubbles::before {
      top: 0;
      left: 0;
    }

    .bubbles::after {
      top: 100%;
      left: 100%;
    }

    .bubbles::before,
    .bubbles::after {
      content: "";
      width: 150%;
      aspect-ratio: 1/1;
      scale: 0;
      transition: 1000ms cubic-bezier(0.76, 0, 0.24, 1);

      background-color: var(--c2);
      border-radius: 50%;

      position: absolute;
      translate: -50% -50%;
    }

    .bubbles:hover > .text {
      color: var(--c1);
    }

    .bubbles:hover::before,
    .bubbles:hover::after {
      scale: 1;
    }

    .bubbles:active {
      scale: 0.98;
      filter: brightness(0.9);
    }

    /* ========== ESTILOS ADICIONALES PARA LAYOUT HORIZONTAL ========== */

    /* T√≠tulos mejorados */
    h2 {
      text-align: center;
      color: #333;
      margin: 0 0 15px 0;
      font-size: 1.3rem;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    /* Separaci√≥n visual de paneles */
    form::before {
      content: "üìã FORMULARIO";
      display: block;
      text-align: center;
      font-size: 0.75rem;
      color: #667eea;
      font-weight: 600;
      letter-spacing: 1px;
      margin-bottom: 15px;
      text-transform: uppercase;
    }

    .previewoutput::before {
      content: "üëÅÔ∏è VISTA PREVIA";
      display: block;
      text-align: center;
      font-size: 0.75rem;
      color: #667eea;
      font-weight: 600;
      letter-spacing: 1px;
      margin-bottom: 10px;
      text-transform: uppercase;
      padding: 10px 0 0 0;
    }

    #listar_arrendatarios::before {
      content: "üóÇÔ∏è BASE DE DATOS";
      display: block;
      text-align: center;
      font-size: 0.75rem;
      color: #667eea;
      font-weight: 600;
      letter-spacing: 1px;
      margin-bottom: 10px;
      text-transform: uppercase;
      grid-column: 1 / -1;
    }

    /* Input y select mejorados */
    input, select {
      transition: all 0.3s ease;
    }

    input:focus, select:focus {
      transform: translateY(-2px);
      box-shadow: 0 8px 16px rgba(102, 126, 234, 0.3) !important;
    }

    /* Display fields mejorados */
    .display-field {
      background: linear-gradient(135deg, #f5f7ff 0%, #f0f2ff 100%);
      border: 1px solid rgba(102, 126, 234, 0.3) !important;
      transition: all 0.3s ease;
    }

    .display-field:hover {
      border-color: #667eea !important;
      background: linear-gradient(135deg, #f0f2ff 0%, #e8ebff 100%);
    }

    /* Contenedor de edici√≥n inline mejorado */
    #containerEditarArrendatario {
      background: linear-gradient(135deg, #f5f7ff 0%, #f0f2ff 100%) !important;
      border-left: 4px solid #667eea !important;
    }

    /* Efecto de modal para edici√≥n */
    #containerEditarArrendatario::before {
      content: "";
      position: absolute;
      top: -8px;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
      border-radius: 2px;
    }

    /* Botones con mejor espaciado */
    .btn {
      transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1) !important;
    }

    .btn:hover {
      transform: translateY(-2px);
    }

    /* Mejora visual para cards en BD */
    #listar_arrendatarios > div {
      border: 1px solid rgba(102, 126, 234, 0.2) !important;
      background: linear-gradient(135deg, #ffffff 0%, #f9fafb 100%) !important;
    }

    #listar_arrendatarios > div:hover {
      border-color: #667eea !important;
      background: linear-gradient(135deg, #f5f7ff 0%, #ffffff 100%) !important;
    }

    /* Etiquetas con mejor contraste */
    label {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      font-weight: 700;
    }

    /* Responsive mejorado */
    @media (max-width: 1400px) {
      form, .previewoutput, #listar_arrendatarios {
        min-width: 85vw;
        max-width: 85vw;
      }
    }

    @media (max-width: 900px) {
      h2 {
        font-size: 1.1rem;
      }

      form, .previewoutput, #listar_arrendatarios {
        padding: 15px;
      }

      label {
        font-size: 0.9rem;
      }
    }
</head>
<body>

    <form action="/GenerarComprobantes/" method="post">
    <h2 id="formTitle">Registro de Servicios y Precios</h2>
    <h2 id="mensaje">Mensaje</h2>
    
    <!-- CONTENEDOR DE EDICI√ìN INLINE -->
    <div id="containerEditarArrendatario" style="display:none; border: 2px solid #667eea; padding: 20px; border-radius: 10px; background: #f0f2ff; margin-bottom: 20px;">
      
      <input type="hidden" id="arrendatario_id">
      
      <!-- Campo: Nombre -->
      <div style="margin-bottom: 15px;">
        <label style="display:block; margin-bottom: 5px; font-weight:bold; color:#333;">Nombre del Arrendatario:</label>
        <div id="display_nombre" class="display-field">-</div>
        <input type="text" id="input_nombre" class="edit-field" style="display:none; width:100%; padding:10px; border:1px solid #ccc; border-radius:5px;" placeholder="Nombre">
      </div>

      <!-- Campo: Ubicaci√≥n -->
      <div style="margin-bottom: 15px;">
        <label style="display:block; margin-bottom: 5px; font-weight:bold; color:#333;">Ubicaci√≥n:</label>
        <div id="display_ubicacion" class="display-field">-</div>
        <input type="text" id="input_ubicacion" class="edit-field" style="display:none; width:100%; padding:10px; border:1px solid #ccc; border-radius:5px;" placeholder="Ubicaci√≥n">
      </div>

      <!-- Campo: Direcci√≥n -->
      <div style="margin-bottom: 15px;">
        <label style="display:block; margin-bottom: 5px; font-weight:bold; color:#333;">Direcci√≥n:</label>
        <div id="display_direccion" class="display-field">-</div>
        <input type="text" id="input_direccion" class="edit-field" style="display:none; width:100%; padding:10px; border:1px solid #ccc; border-radius:5px;" placeholder="Direcci√≥n">
      </div>

      <!-- Campo: Personas -->
      <div style="margin-bottom: 15px;">
        <label style="display:block; margin-bottom: 5px; font-weight:bold; color:#333;">Personas en el Apartamento:</label>
        <div id="display_personas" class="display-field">-</div>
        <input type="number" id="input_personas" class="edit-field" style="display:none; width:100%; padding:10px; border:1px solid #ccc; border-radius:5px;" min="1" placeholder="N√∫mero de personas">
      </div>

      <!-- Campo: Tel√©fono -->
      <div style="margin-bottom: 15px;">
        <label style="display:block; margin-bottom: 5px; font-weight:bold; color:#333;">Tel√©fono:</label>
        <div id="display_telefono" class="display-field">-</div>
        <input type="text" id="input_telefono" class="edit-field" style="display:none; width:100%; padding:10px; border:1px solid #ccc; border-radius:5px;" placeholder="Tel√©fono">
      </div>

      <!-- Campo: Email -->
      <div style="margin-bottom: 15px;">
        <label style="display:block; margin-bottom: 5px; font-weight:bold; color:#333;">Email:</label>
        <div id="display_email" class="display-field">-</div>
        <input type="email" id="input_email" class="edit-field" style="display:none; width:100%; padding:10px; border:1px solid #ccc; border-radius:5px;" placeholder="Email">
      </div>

      <!-- Botones de acci√≥n -->
      <div style="display:flex; gap:10px;">
        <button type="button" id="btnEditarInline" class="btn" style="flex:1;">
          <svg class="btn-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M20.71,7.04C21.1,6.65 21.1,6 20.71,5.63L18.37,3.29C18,2.9 17.35,2.9 16.96,3.29L15.12,5.12L18.87,8.87M3,17.25V21H6.75L17.81,9.93L14.06,6.18L3,17.25Z" />
          </svg>
          <div class="txt-wrapper">
            <div class="txt-1">
              <span class="btn-letter">E</span><span class="btn-letter">d</span><span class="btn-letter">i</span><span class="btn-letter">t</span><span class="btn-letter">a</span><span class="btn-letter">r</span>
            </div>
          </div>
        </button>
        
        <button type="button" id="btnGuardarInline" class="btn" style="flex:1; display:none;">
          <svg class="btn-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M15,9H5V5H15M12,19A7,7 0 0,1 5,12A7,7 0 0,1 12,5A7,7 0 0,1 19,12A7,7 0 0,1 12,19M12,3A9,9 0 0,0 3,12A9,9 0 0,0 12,21A9,9 0 0,0 21,12A9,9 0 0,0 12,3M16.31,16.31L13.9,13.9A4,4 0 0,0 12,14A4,4 0 0,1 8,10A4,4 0 0,1 12,6A4,4 0 0,1 16,10A4,4 0 0,0 14.9,13.9L16.31,15.31V16.31Z" />
          </svg>
          <div class="txt-wrapper">
            <div class="txt-1">
              <span class="btn-letter">G</span><span class="btn-letter">u</span><span class="btn-letter">a</span><span class="btn-letter">r</span><span class="btn-letter">d</span><span class="btn-letter">a</span><span class="btn-letter">r</span>
            </div>
          </div>
        </button>
        
        <button type="button" id="btnCancelarInline" class="btn" style="flex:1; display:none;">
          <svg class="btn-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z" />
          </svg>
          <div class="txt-wrapper">
            <div class="txt-1">
              <span class="btn-letter">C</span><span class="btn-letter">a</span><span class="btn-letter">n</span><span class="btn-letter">c</span><span class="btn-letter">e</span><span class="btn-letter">l</span><span class="btn-letter">a</span><span class="btn-letter">r</span>
            </div>
          </div>
        </button>
      </div>
    </div>

    <!-- Resto del formulario para servicios -->
    <label for="WaterValue">Precio Agua:</label>
    <input type="number" id="WaterValue" name="WaterValue" >

    <label for="LuzValue">Precio Luz:</label>
    <input type="number" id="LuzValue" name="LuzValue" >

    <label for="GasValue">Precio Gas:</label>
    <input type="number" id="GasValue" name="GasValue"  >

    <label for="AseoValue">Precio Aseo:</label>
    <input type="number" id="AseoValue" name="AseoValue" >


    
    <label>Seleccionar Ubicaci√≥n:</label>
    <select id="opciones" name="Selecionador">
      <option value="Amparo">Amparo</option>
      <option value="USA">USA</option>
    </select>


    <button type="submit" id="buttonGenerarPDF" class="btn">
  <svg class="btn-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
    <path d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z" />
  </svg>
  <div class="txt-wrapper">
    <div class="txt-1">
      <span class="btn-letter">G</span><span class="btn-letter">e</span><span class="btn-letter">n</span><span class="btn-letter">e</span><span class="btn-letter">r</span><span class="btn-letter">a</span><span class="btn-letter">r</span>
    </div>
  </div>
</button>

<button type="button" id="buttonPreview" class="btn">
  <svg class="btn-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
    <path d="M12,9A3,3 0 0,0 9,12A3,3 0 0,0 12,15A3,3 0 0,0 15,12A3,3 0 0,0 12,9M12,17A5,5 0 0,1 7,12A5,5 0 0,1 12,7A5,5 0 0,1 17,12A5,5 0 0,1 12,17M12,4.5C7,4.5 2.73,7.61 1,12C2.73,16.39 7,19.5 12,19.5C17,19.5 21.27,16.39 23,12C21.27,7.61 17,4.5 12,4.5Z" />
  </svg>
  <div class="txt-wrapper">
    <div class="txt-1">
      <span class="btn-letter">P</span><span class="btn-letter">r</span><span class="btn-letter">e</span><span class="btn-letter">v</span><span class="btn-letter">i</span><span class="btn-letter">e</span><span class="btn-letter">w</span>
    </div>
  </div>
</button>

<button type="button" id="buttonModifyOutcome" class="btn">
  <svg class="btn-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
    <path d="M20.71,7.04C21.1,6.65 21.1,6 20.71,5.63L18.37,3.29C18,2.9 17.35,2.9 16.96,3.29L15.12,5.12L18.87,8.87M3,17.25V21H6.75L17.81,9.93L14.06,6.18L3,17.25Z" />
  </svg>
  <div class="txt-wrapper">
    <div class="txt-1">
      <span class="btn-letter">E</span><span class="btn-letter">d</span><span class="btn-letter">i</span><span class="btn-letter">t</span><span class="btn-letter">a</span><span class="btn-letter">r</span><span class="btn-letter"> </span><span class="btn-letter">r</span><span class="btn-letter">e</span><span class="btn-letter">s</span><span class="btn-letter">u</span><span class="btn-letter">l</span><span class="btn-letter">t</span><span class="btn-letter">a</span><span class="btn-letter">d</span><span class="btn-letter">o</span>
    </div>
  </div>
</button>

<button type="button" id="buttonModifyDB" class="btn">
  <svg class="btn-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
    <path d="M20.71,7.04C21.1,6.65 21.1,6 20.71,5.63L18.37,3.29C18,2.9 17.35,2.9 16.96,3.29L15.12,5.12L18.87,8.87M3,17.25V21H6.75L17.81,9.93L14.06,6.18L3,17.25Z" />
  </svg>
  <div class="txt-wrapper">
    <div class="txt-1">
      <span class="btn-letter">Editar</span><span class="btn-letter">BD</span>
    </div>
  </div>
</button>
  </form>


<div id="previewoutput" class="previewoutput">
  <div class="preview-header" id="previewHeader">
    <h3>Vista Previa a PDF</h3>
    <span class="preview-toggle">‚ñº</span>
  </div>
  <div class="preview-content" id="previewContent">
    <p><strong>Ubicaci√≥n:</strong> <span id="ubicacion"></span></p>
    <div id="previewList"></div>
    <p><strong>Total agregado:</strong> <span id="totalAgregado"></span></p>
  </div>
</div>

<div id="listar_arrendatarios" style="max-height:100vh; overflow-y:auto; display:grid; gap:12px; width:100%; min-width:400px; max-width:450px; background: white; border-radius: 15px; box-shadow: 0 10px 40px rgba(0,0,0,0.1); padding: 20px; flex-shrink: 0; border: 1px solid rgba(102, 126, 234, 0.2); animation: slideInRight 0.5s ease-out;"></div>

<style>
  @keyframes slideInRight {
    from {
      opacity: 0;
      transform: translateX(50px);
    }
    to {
      opacity: 1;
      transform: translateX(0);
    }
  }

  /* Scrollbar para el contenedor de arrendatarios */
  #listar_arrendatarios::-webkit-scrollbar {
    width: 6px;
  }

  #listar_arrendatarios::-webkit-scrollbar-track {
    background: rgba(102, 126, 234, 0.1);
    border-radius: 10px;
  }

  #listar_arrendatarios::-webkit-scrollbar-thumb {
    background: #667eea;
    border-radius: 10px;
  }

  #listar_arrendatarios::-webkit-scrollbar-thumb:hover {
    background: #764ba2;
  }

  /* Responsive: Para pantallas menores a 1400px */
  @media (max-width: 1400px) {
    body {
      grid-template-columns: 1fr;
      overflow-x: auto;
    }

    form, .previewoutput, #listar_arrendatarios {
      min-width: 90vw;
    }
  }

  /* Responsive: Para tablets */
  @media (max-width: 900px) {
    body {
      grid-template-columns: 1fr;
      gap: 15px;
      padding: 15px;
    }

    form, .previewoutput, #listar_arrendatarios {
      min-width: 100%;
      max-width: 100%;
    }
  }

  /* Mejora visual para el contenedor de edici√≥n inline */
  #containerEditarArrendatario {
    box-shadow: 0 8px 32px rgba(102, 126, 234, 0.15) !important;
    border-color: #667eea !important;
    animation: slideDown 0.4s ease-out;
  }

  @keyframes slideDown {
    from {
      opacity: 0;
      transform: translateY(-20px);
      max-height: 0;
    }
    to {
      opacity: 1;
      transform: translateY(0);
      max-height: 1000px;
    }
  }

  /* Cards de arrendatarios mejoradas */
  #listar_arrendatarios > div {
    animation: fadeInScale 0.3s ease-out;
    transition: all 0.3s ease;
  }

  @keyframes fadeInScale {
    from {
      opacity: 0;
      transform: scale(0.95);
    }
    to {
      opacity: 1;
      transform: scale(1);
    }
  }

  #listar_arrendatarios > div:hover {
    transform: translateY(-4px);
    box-shadow: 0 12px 24px rgba(102, 126, 234, 0.2) !important;
  }
</style>
<script>
  let global_a = [];
function editarArr(id) {
 const arrendatario = global_a.find(a => a.id === id);
 if (!arrendatario) {
  console.log("Arrendatario no encontrado");
  return; 
}
  // 3. Mostrar en consola (para verificar)
  console.log(" Arrendatario seleccionado:", arrendatario);
  idedited = id;
  document.getElementById("arrendatario_id").value = id;
  

  // Prellenar los display fields (textos)
  document.getElementById("display_nombre").textContent = arrendatario.nombre_arrendatario;
  document.getElementById("display_ubicacion").textContent = arrendatario.nombre_ubicacion;
  document.getElementById("display_direccion").textContent = arrendatario.direccion_ubicacion;
  document.getElementById("display_personas").textContent = arrendatario.personas_por_arrendatario || "-";
  document.getElementById("display_telefono").textContent = arrendatario.telefono || "-";
  document.getElementById("display_email").textContent = arrendatario.email || "-";

  // Prellenar los inputs (ocultos por ahora)
  document.getElementById("input_nombre").value = arrendatario.nombre_arrendatario;
  document.getElementById("input_ubicacion").value = arrendatario.nombre_ubicacion;
  document.getElementById("input_direccion").value = arrendatario.direccion_ubicacion;
  document.getElementById("input_personas").value = arrendatario.personas_por_arrendatario;
  document.getElementById("input_telefono").value = arrendatario.telefono || "";
  document.getElementById("input_email").value = arrendatario.email || "";

  document.getElementById("containerEditarArrendatario").style.display = "block";
  document.getElementById("formTitle").textContent = "Editar Arrendatario";
}

function edit_mod_activated(){
  modoEdicionInline = true;

  document.querySelectorAll(".display-field").forEach(el => {
    el.style.display = "none";
  });

  document.querySelectorAll(".edit-field").forEach(el => {
    el.style.display = "block";0
  });
  // Cambiar botones
  document.getElementById("btnEditarInline").style.display = "none";
  document.getElementById("btnGuardarInline").style.display = "block";
  document.getElementById("btnCancelarInline").style.display = "block";
  console.log("Modo edici√≥n inline ");

}

function cancel_edit_mod(){
  modoEdicionInline = false;

  document.querySelectorAll(".display-field").forEach(el => {
    el.style.display = "block";
  });

  document.querySelectorAll(".edit-field").forEach(el => {
    el.style.display = "none";
  });
  // Cambiar botones
  document.getElementById("btnEditarInline").style.display = "block";
  document.getElementById("btnGuardarInline").style.display = "none";
  document.getElementById("btnCancelarInline").style.display = "none";
  console.log("Cancel√≥ edici√≥n inline ");
}
async function changes_save_inline (){
const id = document.getElementById("arrendatario_id").value;

  const datosActualizados = {
    nombre_arrendatario: document.getElementById("input_nombre").value,
    nombre_ubicacion: document.getElementById("input_ubicacion").value,
    direccion_ubicacion: document.getElementById("input_direccion").value,
    personas_por_arrendatario: parseInt(document.getElementById("input_personas").value),
    telefono: document.getElementById("input_telefono").value,
    email: document.getElementById("input_email").value
  };

  console.log(" Enviando datos actualizados:", datosActualizados);

  try {
    const res = await fetch(`/api/v1/update_data_db/?arrendatario_id=${id}`, {
      method: "PUT",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(datosActualizados)
    });

    if (!res.ok) {
      throw new Error(`Error ${res.status}: No se pudo actualizar`);
    }

    const respuesta = await res.json();
    console.log("Actualizado correctamente:", respuesta);

    alert(" Arrendatario actualizado correctamente!");

    // Actualizar display fields con los nuevos valores
    document.getElementById("display_nombre").textContent = datosActualizados.nombre_arrendatario;
    document.getElementById("display_ubicacion").textContent = datosActualizados.nombre_ubicacion;
    document.getElementById("display_direccion").textContent = datosActualizados.direccion_ubicacion;
    document.getElementById("display_personas").textContent = datosActualizados.personas_por_arrendatario;
    document.getElementById("display_telefono").textContent = datosActualizados.telefono || "-";
    document.getElementById("display_email").textContent = datosActualizados.email || "-";

    // Volver a modo lectura
    cancel_edit_mod();

    // Recargar la lista de cards
    cargarArrendatarios();

  } catch (error) {
    console.error(" Error al guardar:", error);
    alert(" Error: " + error.message);
  }
}

// Event listeners
document.getElementById("btnEditarInline").addEventListener("click", edit_mod_activated);
document.getElementById("btnGuardarInline").addEventListener("click", changes_save_inline);
document.getElementById("btnCancelarInline").addEventListener("click", cancel_edit_mod);


// Cargar y mostrar arrendatarios en cards
async function cargarArrendatarios() {
  try {
    const respuesta = await fetch("/Arrendatarios/");
    if (!respuesta.ok) {
      throw new Error(`Error al obtener los arrendatarios: ${respuesta.status}`);
    }
    const data = await respuesta.json();
    const items = data.data || [];
    global_a = items;     
    // Renderizar como cards similar al preview
    const container = document.getElementById("listar_arrendatarios");
    if (items.length === 0) {
      container.innerHTML = "<p style='text-align:center; color:#999;'>No hay arrendatarios registrados</p>";
      return;
    }
    
    container.innerHTML = items.map(a => `
      <div style="border:1px solid #e0e0e0; border-radius:8px; padding:12px; background:#f9f9f9; transition: all 0.2s ease;">
        <p style="margin:8px 0;"><strong style="color:#667eea;">Nombre:</strong> ${a.nombre_arrendatario}</p>
        <p style="margin:8px 0;"><strong style="color:#667eea;">Ubicaci√≥n:</strong> ${a.nombre_ubicacion}</p>
        <p style="margin:8px 0;"><strong style="color:#667eea;">Direcci√≥n:</strong> ${a.direccion_ubicacion}</p>
        <p style="margin:8px 0;"><strong style="color:#667eea;">Personas:</strong> ${a.personas_por_arrendatario ?? "-"}</p>
        <p style="margin:8px 0;"><strong style="color:#667eea;">Tel:</strong> ${a.telefono ?? "-"}</p>
        <p style="margin:8px 0;"><strong style="color:#667eea;">Email:</strong> ${a.email ?? "-"}</p>
        <button class="bubbles" onclick="editarArr(${a.id})" style="margin-top:10px;">
          <span class="text">Editar</span>
        </button>
      </div>
    `).join("");
  } catch (error) {
    console.error("Error en la solicitud GET:", error);
    document.getElementById("listar_arrendatarios").innerHTML = `<p style="color:red;">Error al cargar los datos</p>`;
  }
}

document.getElementById("buttonModifyDB").addEventListener("click", cargarArrendatarios);


document.addEventListener("DOMContentLoaded", () => {
  const form = document.querySelector("form");
  const buttonPreview = document.getElementById("buttonPreview");
  const previewEl = document.getElementById("previewoutput");
  const ubicacionEl = document.getElementById("ubicacion");
  const listEl = document.getElementById("previewList");
  const totalAgregadoEl = document.getElementById("totalAgregado");

  const getFormValues = () => ({
    WaterValue: document.getElementById("WaterValue").value || 0,
    LuzValue: document.getElementById("LuzValue").value || 0,
    GasValue: document.getElementById("GasValue").value || 0,
    AseoValue: document.getElementById("AseoValue").value || 0,
    Selecionador: document.getElementById("opciones").value
  });

  buttonPreview.addEventListener("click", async (e) => {
    e.preventDefault();

    const values = getFormValues();
    const formData = new FormData();
    formData.append("WaterValue", values.WaterValue);
    formData.append("LuzValue", values.LuzValue);
    formData.append("GasValue", values.GasValue);
    formData.append("AseoValue", values.AseoValue);
    formData.append("Selecionador", values.Selecionador);

    try {
      const res = await fetch("/PreviewComprobantes/", {
        method: "POST",
        body: formData
      });
      if (!res.ok) {
        throw new Error("Error en preview");
      }
      const data = await res.json();

      // Render del preview
      ubicacionEl.textContent = data.ubicacion;
      totalAgregadoEl.textContent = `$ ${data.sum_total.toFixed(2)}`;

      // Lista por arrendatario
      listEl.innerHTML = "";
      data.arrendatarios.forEach((a) => {
        const card = document.createElement("div");
        card.style.padding = "10px";
        card.style.marginBottom = "10px";
        card.style.border = "1px solid #ddd";
        card.style.borderRadius = "8px";
        card.innerHTML = `
          <p><strong>${a.nombre_arrendatario}</strong> (${a.personas_por_arrendatario} persona(s))</p>
          <p>Direcci√≥n: ${a.direccion_ubicacion}</p>
          <p>Luz: $ ${a.servicios.luz.toFixed(2)}</p>
          <p>Agua: $ ${a.servicios.agua.toFixed(2)}</p>
          <p>Gas: $ ${a.servicios.gas.toFixed(2)}</p>
          <p>Aseo: $ ${a.servicios.aseo.toFixed(2)}</p>
          <p><strong>Total:</strong> $ ${a.total.toFixed(2)}</p>
        `;
        listEl.appendChild(card);
      });

      previewEl.classList.add("show");
    } catch (err) {
      console.error(err);
      alert("No se pudo generar la vista previa.");
    }
  });
});
</script>

</body>
</html>
